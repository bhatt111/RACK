#!/usr/bin/env swipl

:- initialization(main, main).

:- use_module(library(optparse)).
:- use_module(paths).
:- consult([analyze_rack,common_opts]).

main :-
    parse_args(
        [
            [opt(instance_prefix), meta('PREFIX'), type(atom),
             shortflags([i]), longflags(['instance_prefix', 'instance']),
             default(none),
             help('Prefix of instances to analyze (or "all" to analyze all instances)')]
        ], Opts, _PosArgs),
    get_instance_pfx(Opts, Pfx),
    (Pfx = none, !, report ; report(Pfx)).

get_instance_pfx(Opts, Pfx) :- member(instance_prefix(Pfx), Opts), !.
get_instance_pfx(_, none).
